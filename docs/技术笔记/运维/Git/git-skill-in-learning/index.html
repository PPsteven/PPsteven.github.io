<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-技术笔记/运维/Git/Git实战" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.2.1">
<title data-rh="true">Git in Action | CodePainter</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://ppsteven.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://ppsteven.github.io/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://ppsteven.github.io/docs/技术笔记/运维/Git/git-skill-in-learning"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Git in Action | CodePainter"><meta data-rh="true" name="description" content="主要记录 git 在实际使用中碰到的问题，会逐步慢慢积累"><meta data-rh="true" property="og:description" content="主要记录 git 在实际使用中碰到的问题，会逐步慢慢积累"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ppsteven.github.io/docs/技术笔记/运维/Git/git-skill-in-learning"><link data-rh="true" rel="alternate" href="https://ppsteven.github.io/docs/技术笔记/运维/Git/git-skill-in-learning" hreflang="en"><link data-rh="true" rel="alternate" href="https://ppsteven.github.io/docs/技术笔记/运维/Git/git-skill-in-learning" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="CodePainter RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="CodePainter Atom Feed"><link rel="stylesheet" href="/assets/css/styles.4822eac9.css">
<script src="/assets/js/runtime~main.1ef7c7b3.js" defer="defer"></script>
<script src="/assets/js/main.4693665b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="CodePainter" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="CodePainter" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">CodePainter</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/category/前端">Documents</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Topics</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/面试技巧/数据结构/链表/链表简介">Interview Notes</a></li></ul></div><a href="https://github.com/PPsteven" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/前端">前端</a><button aria-label="Expand sidebar category &#x27;前端&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/后端">后端</a><button aria-label="Expand sidebar category &#x27;后端&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/运维">运维</a><button aria-label="Collapse sidebar category &#x27;运维&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/技术笔记/运维/Docker/docker-elasticsearch-Kibana-installation">Docker</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/技术笔记/运维/Linux/linux-environment-variable-config-file-order">Linux</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/docs/技术笔记/运维/Git/git-skill-in-learning">Git</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/技术笔记/运维/Git/git-skill-in-learning">Git in Action</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/技术笔记/运维/Git/Git工作流">Git工作流</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/技术笔记/运维/Git/Github/github-search-tips">Github</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/技术笔记/运维/DB/SQL进阶">DB</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/技术笔记/运维/Mac/Mac 开发环境配置">Mac</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/技术笔记/其它/学习资料/电子书/Go语言电子书">其它</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/cheetsheet">Cheetsheet</a><button aria-label="Expand sidebar category &#x27;Cheetsheet&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/运维"><span itemprop="name">运维</span></a><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Git</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Git in Action</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Git in Action</h1></header><p>主要记录 git 在实际使用中碰到的问题，会逐步慢慢积累</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="高频问题与实践方案">高频问题与实践方案<a href="#高频问题与实践方案" class="hash-link" aria-label="Direct link to 高频问题与实践方案" title="Direct link to 高频问题与实践方案">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="新项目与远端同步">新项目与远端同步<a href="#新项目与远端同步" class="hash-link" aria-label="Direct link to 新项目与远端同步" title="Direct link to 新项目与远端同步">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ git init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git remote add origin git@e.coding.net:datamate/pujiangjiaoye.git # 添加远端仓库</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git branch --set-upstream-to=origin/master # 设置分支对应关系</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git push --set-upstream origin master # 设置push 对应的远程仓库，建立本地分支的上游</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git remote -v # 查看分支</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>当我们尝试push的时候又会出现一个问题</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">error: 推送一些引用到 &#x27;git@e.coding.net:datamate/pujiangjiaoye.git&#x27; 失败</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">提示：更新被拒绝，因为您当前分支的最新提交落后于其对应的远程分支。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">提示：再次推送前，先与远程变更合并（如 &#x27;git pull ...&#x27;）。详见</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">提示：&#x27;git push --help&#x27; 中的 &#x27;Note about fast-forwards&#x27; 小节。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 按照提示，尝试用git pull 合并,又失败</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ git pull</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fatal: 拒绝合并无关的历史</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>原因是我们本地与远程的版本不一致，但是我们是新提交，怎么会出现这样的问题呢？
因为很多平台在我们创建项目的时候，自动帮我们创建了README.md文件，所以会有不一致的情况存在。git pull 失败的原因是，两个不一致的文件没有<em><strong>共同祖先的历史</strong></em>。</p>
<p>解决方法也很简单</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git pull origin master --allow-unrelated-histories </span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="https://cdn.jsdelivr.net/gh/PPsteven/pictures/img/20200124225406.png" alt="" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="https://cdn.jsdelivr.net/gh/PPsteven/pictures/img/20200124225457.png" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="修改上一次的提交">修改上一次的提交<a href="#修改上一次的提交" class="hash-link" aria-label="Direct link to 修改上一次的提交" title="Direct link to 修改上一次的提交">​</a></h3>
<p>git 是分支管理的工具，我们的工作最好在一个 commit 中提交相应的代码，完成一个功能（如 bugfix 或者 feature_add ）。但是有的时候，我们的提交经过 Code Review 之后，可能会被打回来。这样面对新的修改，不应该重复提交。</p>
<p>首先，我们可以先建立一个提交。面对第二个文件（这里我们给 a 新增了 Hello world again ）</p>
<p><img decoding="async" loading="lazy" src="https://cdn.jsdelivr.net/gh/PPsteven/pictures/img/20200124225533.png" alt="" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" src="https://cdn.jsdelivr.net/gh/PPsteven/pictures/img/20200124225610.png" alt="" class="img_ev3q"></p>
<p>第一种选择，我们提交两个 commit</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git add .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git commit -m &quot;second commit&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><img decoding="async" loading="lazy" src="https://cdn.jsdelivr.net/gh/PPsteven/pictures/img/20200124225659.png" alt="" class="img_ev3q"></p>
<blockquote>
<p>第二种选择，我们直接修改上一次的修改（推荐）</p>
</blockquote>
<p>工作流如下</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git add .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git commit --amend # 代表直接在上一次的提交修改，这里会弹出上一次 commit 的信息。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git push -f # 由于我们只是改了本地，提交的时候使用 -f 强制推送一下</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>这里强烈建议，使用 --amend 的方法的时候，一定要检查 commit 的信息，确定不是把别人的给冲掉了。</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="https://cdn.jsdelivr.net/gh/PPsteven/pictures/img/20200124225740.png" alt="" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="服务器端强制同步远端-git-仓库">服务器端强制同步远端 git 仓库<a href="#服务器端强制同步远端-git-仓库" class="hash-link" aria-label="Direct link to 服务器端强制同步远端 git 仓库" title="Direct link to 服务器端强制同步远端 git 仓库">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git fetch </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git reset  --hard origin/master # 要强制同步的分支！--hard 是丢弃分支的修改</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git pull</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Already up-to-date.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="为什么修改了-gitignore-文件忽略项还是不起作用">为什么修改了 <code>.gitignore</code> 文件，忽略项还是不起作用<a href="#为什么修改了-gitignore-文件忽略项还是不起作用" class="hash-link" aria-label="Direct link to 为什么修改了-gitignore-文件忽略项还是不起作用" title="Direct link to 为什么修改了-gitignore-文件忽略项还是不起作用">​</a></h3>
<p>新建的文件在git中会有缓存，如果某些文件已经被纳入了版本管理中，就算是在.gitignore中已经声明了忽略路径也是不起作用的，这时候我们就应该先把本地缓存删除，然后再进行git的push</p>
<p>git清除本地缓存命令如下：</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git rm -r --cached .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git add .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>下面附上我的 <code>.gitignore</code> 文件</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Windows:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Thumbs.db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ehthumbs.db</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Desktop.ini</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># MAC:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*.DS_Store</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Python:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*.py[cod]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*.egg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*.egg-info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># My configurations:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*.log</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">*.log.*</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>如何使用 git merge</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 开发分支（dev）上的代码达到上线的标准后，要合并到 master 分支</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git checkout dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git pull</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git checkout master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git pull </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git merge dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git push -u origin master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 当master代码改动了，需要更新开发分支（dev）上的代码</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git checkout master </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git pull </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git checkout dev # 这里默认dev 远端没有动</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git merge master </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git push -u origin dev</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<blockquote>
<p>参考: <a href="https://blog.csdn.net/zl1zl2zl3/article/details/94019526" target="_blank" rel="noopener noreferrer">git merge最简洁用法</a></p>
</blockquote>
<p>推荐一个 <code>git merge</code> 比较好的教程： <a href="https://www.jianshu.com/p/1a7e38cdbf76" target="_blank" rel="noopener noreferrer">merge：合并 commits</a></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="管理多个git账号">管理多个git账号<a href="#管理多个git账号" class="hash-link" aria-label="Direct link to 管理多个git账号" title="Direct link to 管理多个git账号">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="介绍">介绍<a href="#介绍" class="hash-link" aria-label="Direct link to 介绍" title="Direct link to 介绍">​</a></h3>
<p>Git共有三个级别的 <code>config</code> 文件，分别是 <code>system</code> 、<code>global</code> 和 <code>local</code>。<code>global</code> 的在<code>$home\.gitconfig</code>，local的在仓库目录下的<code>.git\config</code>。这三个级别都分别配置了用户信息，当<code>git commit</code>时，会依次从local、global、system里读取用户信息。因此，我们利用local的配置来设置不同的用户信息</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="生成公钥">生成公钥<a href="#生成公钥" class="hash-link" aria-label="Direct link to 生成公钥" title="Direct link to 生成公钥">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 查看git账号，会按顺序读取local,global的用户信息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git config user.name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git config user.email</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 若是在空仓库中使用如下命令会出错，我们在仓库中使用--local，提前  运行git init</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git config --local -l</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">fatal: --local 只能在一个仓库内使用</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 更改本地账号</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git config --local/--global user.name &quot;Your name&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git config --local/--global user.email &quot;Your email&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 生成公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh-keygen -t rsa -C &quot;your_email@example.com&quot; -f ./</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-t rsa 约定加密类型</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-C 添加评论</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-f 保存秘钥的地址（默认是 ~/.ssh/id_rsa）</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>生成公钥的地方需要注意的是，生成的公钥会自动生成在<code>~/.ssh/id_rsa</code>中，若是你有多个账号的话，无疑会把原先的秘钥覆盖。可以在后续弹出的提示中约定key保存的地址</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Enter file in which to save the key (/Users/you/.ssh/id_rsa): [Press enter]  // 推荐使用默认地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enter passphrase (empty for no passphrase):   //此处点击 Enter 键即可，也可以填写密码，填写密码后每次使用 SSH 方式推送代码时都会要求输入密码，由于这个 Key 也不是用于军事目的，所以也无需设置密码。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>也可以在ssh-keygen中约定好</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh-keygen -t rsa -C &quot;your_email@example.com&quot; -f ~/.ssh/coding </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-f 保存在yon下的.ssh/coding文件中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Your identification has been saved in /Users/ppsteven/.ssh/coding.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Your public key has been saved in /Users/ppsteven/.ssh/coding.pub.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">The key fingerprint is:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">SHA256:P6R/Fo70VkCyKsQsFXXX... XXX@outlook.com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>.ssh 文件夹下也多了<code>coding</code>和<code>coding.pub</code>两个文件</p>
<p>coding是你的私钥，需要好好保管，在下面的配置文件中还需要使用，用以证明你自己的身份，coding.pub是公钥，我们需要上传到github，coding，码云等平台上去。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="上传公钥">上传公钥<a href="#上传公钥" class="hash-link" aria-label="Direct link to 上传公钥" title="Direct link to 上传公钥">​</a></h4>
<p>这里只要找到对应上传的地方上传即可，一般平台都有对应的教程，下面我们copy一下coding的操作。</p>
<p><img decoding="async" loading="lazy" src="https://cdn.jsdelivr.net/gh/PPsteven/pictures/img/20200119133041.png" alt="" class="img_ev3q"></p>
<blockquote>
<p>mac 复制文件小技巧</p>
</blockquote>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat coding.pub | pbcopy # 输出到剪切板</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>pbcopy  : 表示复制剪切版
pbpaste ：表示粘贴剪切版</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="配置config文件和添加私钥">配置config文件和添加私钥<a href="#配置config文件和添加私钥" class="hash-link" aria-label="Direct link to 配置config文件和添加私钥" title="Direct link to 配置config文件和添加私钥">​</a></h3>
<p>若是拥有多个账号，需要在 .ssh 下配置多个账号的配置文件 config ，这个配置文件是用来作为路由使用。
我们需要检查是否存在 <code>~/.ssh/config</code> 文件，不存在的话就创建如下文件。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ~/.ssh/config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host github # 别名，使用正则表达式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # connect to github by git@github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	User git # 用户名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	HostName github.com # 服务器地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	IdentityFile ~/.ssh/id_rsa # 私钥地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host coding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	HostName e.coding.net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	User git</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	IdentityFile ~/.ssh/coding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host *.works.*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	HostName devops.works</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	IdentityFile ~/.ssh/id_rsa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host hostmem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  HostName 195.85.35.15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  IdentityFile ~/.ssh/id_rsa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	User ppsteven # 默认用户</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	AddKeysToAgent yes # 自动添加到 ssh-agent</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	IdentityFile ~/.ssh/id_rsa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	IdentityFile ~/.ssh/coding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	ServerAliveInterval 60</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	ServerAliveCountMax 3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>下面解释一下上述配置文件的含义</p>
<p>首先，每一项配置文件的含义都可以通过 <code>man ssh_config</code> 查看，也可以通过</p>
<ul>
<li><a href="https://linux.die.net/man/5/ssh_config" target="_blank" rel="noopener noreferrer">ssh_config(5) - Linux man page</a>  Linux 帮助文件</li>
<li><a href="https://man.openbsd.org/ssh_config.5" target="_blank" rel="noopener noreferrer">ssh_config(5)-OpenBSD</a>  MacOS 帮助文件</li>
</ul>
<p>进行在线查询。</p>
<ul>
<li>
<p>Host 应填写正则表达式，是作为hosts的别称存在</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Host: 192.168.1.?  #  配置所有 192.168.1.[0-9] 的</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   HostName: 192.168.1.3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host targaryen</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HostName 192.168.1.10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User daenerys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Port 7654</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    IdentityFile ~/.ssh/targaryen.key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Host: *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   User: root # 所用网站都使用的默认账号</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
</li>
<li>
<p><code>HostName</code>：真实的host地址</p>
</li>
<li>
<p><code>User</code>：建立 ssh 连接所用的账号，一般如果是远程登录的话是 <code>root</code> , 用于 <code>git</code> 拉取代码的话，一般是 <code>git</code></p>
<p>连接服务器时，会将 User 和 HostName 进行拼接，如 <code>git@github.com</code></p>
</li>
<li>
<p><code>IdentityFile</code>：私钥存储的地址</p>
</li>
<li>
<p><code>AddKeysToAgent</code> : 自动添加私钥到 <code>ssh-agent</code> 中去。</p>
</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="多账号管理">多账号管理<a href="#多账号管理" class="hash-link" aria-label="Direct link to 多账号管理" title="Direct link to 多账号管理">​</a></h4>
<p>通过 <code>~/.ssh/config</code> 文件对多个 <code>git 账号进行管理</code>，其本质是针对不同的 Host 使用不同的私钥进行验证，所以在使用时需要使用自定义的别名，让 ssh 能根据别 名找到对应网站的私钥地址，这种方式和服务器路由匹配的原理类似。</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git clone git@e.coding.net:datamate/demo.git # ssh 方式，此时并不会自动识别对应的 ~/.ssh/coding 的私钥地址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone coding:datamate/demo.git # 匹配到 coding 规则</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git clone git@coding:datamate/demo.git # 匹配到 coding 规则</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>通过起别名的方式，根据 <code>~/.ssh/config</code> 文件，让我们找到不同 <code>Host</code> 的私钥文件位置，那对于不起别名的方式，有没有方法可以做到让系统自动匹配到对应的私钥地址呢? 有，通过 <code>ssh-agent</code></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="ssh-agent是什么">ssh-agent是什么<a href="#ssh-agent是什么" class="hash-link" aria-label="Direct link to ssh-agent是什么" title="Direct link to ssh-agent是什么">​</a></h4>
<p>那么 <code>ssh-agent</code> 的作用是什么呢？<strong>ssh-agent 是一个用于存储私钥的临时性的 session 服务</strong>，当我们使用秘钥登录服务器时，ssh-agent 会启动一个进程在内存里保存这些私钥。之后每次登录时，ssh 客户端都会跟 ssh-agent 请求是否有目标主机的私钥；如果有，ssh 客户端便能直接登录目标主机。</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh-add -D # 清空 ssh-agent 管理的秘钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">All identities removed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh root@195.85.35.153 -i myserver # 登录服务器，并使用指定的私钥 myserver</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh-add -l # 此时观察 ssh-agent 存储的秘钥，发现 ssh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2048 SHA256:6PVJJCR1H/3M977orF4EfJgk0d9bZoul538/MtzBXZY ppsteven@ppstevendeMacBook-Pro.local (RSA)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh root@195.85.35.153 # 此时，就算不指定 myserver 私钥，也能成功登录服务器，原因是ssh已经在ssh-agent中找到了存储的私钥。</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="基本命令">基本命令<a href="#基本命令" class="hash-link" aria-label="Direct link to 基本命令" title="Direct link to 基本命令">​</a></h4>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh-agent bash # 启动 ssh-agent 服务</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh-add -D # 删除之前存储的key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh-add -l # 查看存储的key，这里应该是空的</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh-add ~/.ssh/id_rsa # 添加私钥 id_rsa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh-add ~/.ssh/coding # 添加私钥 coding</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="如何添加-ssh-agent">如何添加 ssh-agent<a href="#如何添加-ssh-agent" class="hash-link" aria-label="Direct link to 如何添加 ssh-agent" title="Direct link to 如何添加 ssh-agent">​</a></h4>
<p>手动添加</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh-add ~/.ssh/coding</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>每次使用ssh时自动添加</p>
<p>需要配置 <code>~/.ssh/config</code></p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">AddKeysToAgent yes # 自动添加私钥到 ssh-agent 中</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh root@demo.com # 登录成功后会自动添加</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ssh -T git@github.com # 测试成功后会自动添加</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="测试ssh是否设置成功">测试ssh是否设置成功<a href="#测试ssh是否设置成功" class="hash-link" aria-label="Direct link to 测试ssh是否设置成功" title="Direct link to 测试ssh是否设置成功">​</a></h3>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ssh -T 后面的名字是上面的别名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh -T github</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hi PPsteven! You&#x27;ve successfully authenticated, but GitHub does not provide shell access.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(base)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh -T coding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Coding 提示: Hello ppsteven, You&#x27;ve connected to Coding.net via SSH. This is a personal key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ppsteven，你好，你已经通过 SSH 协议认证 Coding.net 服务，这是一个个人公钥</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(base)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 不使用别名时</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 第一次测试的时候，需要指定私钥位置，之后私钥会自动加入 ssh-agent 中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh -T git@e.coding.net -i ~/.ssh/coding </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CODING 提示: Hello ppsteven, You&#x27;ve connected to coding.net via SSH. This is a Personal Key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ppsteven，你好，你已经通过 SSH 协议认证 coding.net 服务，这是一个个人公钥.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">公钥指纹：42:c6:f4:f6:39:1f:d7:84:e0:cb:19:a3:ad:25:62:20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 私钥先加入 ssh-agent 中，后测试</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh-add ~/.ssh/coding</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh -T git@e.coding.net</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CODING 提示: Hello ppsteven, You&#x27;ve connected to coding.net via SSH. This is a Personal Key.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ppsteven，你好，你已经通过 SSH 协议认证 coding.net 服务，这是一个个人公钥.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">公钥指纹：42:c6:f4:f6:39:1f:d7:84:e0:cb:19:a3:ad:25:62:20</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="自动添加秘钥的几种方法">自动添加秘钥的几种方法<a href="#自动添加秘钥的几种方法" class="hash-link" aria-label="Direct link to 自动添加秘钥的几种方法" title="Direct link to 自动添加秘钥的几种方法">​</a></h3>
<p>为什么要自动添加 <code>秘钥</code> ，原因是 <code>ssh-agent</code> 是将所有的秘钥存在内存中，这意味着当电脑重启或初次启动的时候，ssh-agent 中存储的私钥会被清空，我们还是需要做 <code>一次</code> 手动添加私钥的操作。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="方案一使用-keychainmac-弃用">方案一：使用 keychain（Mac-弃用）<a href="#方案一使用-keychainmac-弃用" class="hash-link" aria-label="Direct link to 方案一：使用 keychain（Mac-弃用）" title="Direct link to 方案一：使用 keychain（Mac-弃用）">​</a></h4>
<p>keychain 是 Mac 电脑上的钥匙串服务，作用是存储密码、秘钥，证书等信息。Win 和 Linux 也有对应的机制，没有研究。</p>
<p>首先，我们要保证 <code>config</code> 里面有这样两段代码，Mac OS 10.12.2 以上系统需要，不然的话，无法持久化的添加到钥匙串中。</p>
<div class="language-diff codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-diff codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ~/.ssh/config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+ Host *  </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+   AddKeysToAgent yes # 把私钥添加到 ssh-agent 中</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+   UseKeychain yes # Mac 上秘钥被持久化到&quot;钥匙串&quot;中，代表从钥匙串中使用保存的秘钥</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>此时，当你运行 <code>ssh</code> 后，私钥会自动添加到 <strong>ssh-agent</strong>和 <strong>钥匙串</strong> 中，下面在mac中的 <strong>钥匙串</strong> 找到了添加的私钥。</p>
<blockquote>
<p>需要注意的是，Mac上使用 ssh-add -K /path/to/storekey 已经不能直接存储秘钥了，mac 只会存储带 <strong>passphrase</strong> 的秘钥，对于不带 <strong>passphrase</strong> 验证的秘钥，Mac的 KeyChain 不会自动保存。可以手动在 Mac 的钥匙串中加入，然后通过 ssh-add -A 添加钥匙串中的秘钥</p>
</blockquote>
<p><img decoding="async" loading="lazy" src="https://cdn.jsdelivr.net/gh/PPsteven/pictures/img/20200222181451.png" alt="" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="方案二添加到启动配置中去通用">方案二：添加到启动配置中去（通用）<a href="#方案二添加到启动配置中去通用" class="hash-link" aria-label="Direct link to 方案二：添加到启动配置中去（通用）" title="Direct link to 方案二：添加到启动配置中去（通用）">​</a></h4>
<p>直接将所有的秘钥添加到 <code>~/.ssh/config</code> 中</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Host *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   IdentityFile path/to/key1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   IdentityFile path/to/key2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>对于 Centos 系统，由于 <code>ssh-agent</code> 不会自动启动，所以需要单独运行 <code>eval &quot;$(ssh-agent -s)&quot;</code>，参考 <a href="https://medium.com/@medley56_82999/i-recently-went-down-a-rabbit-hole-debugging-some-ssh-problems-cross-platform-and-wanted-to-make-bc6890eaf758" target="_blank" rel="noopener noreferrer">Ubuntu、Mac、Centos下ssh-agent 对比</a></p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ eval &quot;$(ssh-agent -s)&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Agent pid 59566</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ssh-add ~/.ssh/id_rsa</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>下一个问题，应该把这一段代码添加到哪里。这里的建议是加到或者 <code>.profile</code> ，不建议直接添加到 <code>~/.bashrc</code> 或 <code>~/.zshrc</code> 中，因为这样每次打开一个 <code>SHELL</code> 就会开一个 <code>ssh-agent</code> 服务，最终会拖垮服务器。</p>
<p>更多的地方参考我的另一篇教程：<code>linux 环境变量执行顺序</code></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="参考资料">参考资料<a href="#参考资料" class="hash-link" aria-label="Direct link to 参考资料" title="Direct link to 参考资料">​</a></h3>
<p><strong>如何添加多账号</strong></p>
<ul>
<li>
<p><a href="https://segmentfault.com/a/1190000016302881" target="_blank" rel="noopener noreferrer">如何设置多个Git帐号</a></p>
</li>
<li>
<p><a href="https://help.coding.net/docs/project/features/ssh.html?_ga=2.7248818.1438703294.1578809110-58920171.1578071988" target="_blank" rel="noopener noreferrer">coding帮助中心</a></p>
</li>
</ul>
<p>下面是 google 出来的解答，质量很高，建议参考</p>
<p><a href="https://www.freecodecamp.org/news/manage-multiple-github-accounts-the-ssh-way-2dadc30ccaca/" target="_blank" rel="noopener noreferrer">How to manage multiple GitHub accounts on a single machine with SSH keys</a></p>
<p><strong>自动添加ssh账号</strong></p>
<ul>
<li>
<p><a href="https://segmentfault.com/q/1010000000835302" target="_blank" rel="noopener noreferrer">是否必须每次添加ssh-add (推荐看)</a></p>
</li>
<li>
<p><a href="https://help.github.com/en/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent" target="_blank" rel="noopener noreferrer">Generating a new SSH key and adding it to the ssh-agent (github 官方推荐流程)</a></p>
</li>
</ul></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-tags-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/docs/tags/git">Git</a></li></ul></div></div><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/01.技术笔记/03.运维/03.Git/01.Git实战.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/技术笔记/运维/Linux/centos-install-introduction"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Centos 环境配置（持续总结）</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/技术笔记/运维/Git/Git工作流"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Git工作流</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#高频问题与实践方案" class="table-of-contents__link toc-highlight">高频问题与实践方案</a><ul><li><a href="#新项目与远端同步" class="table-of-contents__link toc-highlight">新项目与远端同步</a></li><li><a href="#修改上一次的提交" class="table-of-contents__link toc-highlight">修改上一次的提交</a></li><li><a href="#服务器端强制同步远端-git-仓库" class="table-of-contents__link toc-highlight">服务器端强制同步远端 git 仓库</a></li><li><a href="#为什么修改了-gitignore-文件忽略项还是不起作用" class="table-of-contents__link toc-highlight">为什么修改了 <code>.gitignore</code> 文件，忽略项还是不起作用</a></li></ul></li><li><a href="#管理多个git账号" class="table-of-contents__link toc-highlight">管理多个git账号</a><ul><li><a href="#介绍" class="table-of-contents__link toc-highlight">介绍</a></li><li><a href="#配置config文件和添加私钥" class="table-of-contents__link toc-highlight">配置config文件和添加私钥</a></li><li><a href="#测试ssh是否设置成功" class="table-of-contents__link toc-highlight">测试ssh是否设置成功</a></li><li><a href="#自动添加秘钥的几种方法" class="table-of-contents__link toc-highlight">自动添加秘钥的几种方法</a></li><li><a href="#参考资料" class="table-of-contents__link toc-highlight">参考资料</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/PPsteven" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 PPsteven. Built with Docusaurus. Hosted by Github Pages.</div></div></div></footer></div>
</body>
</html>