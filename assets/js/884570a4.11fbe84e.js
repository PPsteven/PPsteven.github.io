"use strict";(self.webpackChunkcodepainter=self.webpackChunkcodepainter||[]).push([[360],{28232:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>i,contentTitle:()=>o,default:()=>p,frontMatter:()=>c,metadata:()=>a,toc:()=>l});var n=r(74848),s=r(28453);const c={title:"Python \u5185\u5b58\u6cc4\u6f0f\u5206\u6790--\u5e38\u7528\u547d\u4ee4",date:new Date("2021-01-26T15:32:16.000Z"),slug:"/pages/7d5dc0/",categories:["python"]},o=void 0,a={id:"\u6280\u672f\u7b14\u8bb0/\u540e\u7aef/Python/python\u5185\u5b58\u6cc4\u6f0f\u5206\u6790",title:"Python \u5185\u5b58\u6cc4\u6f0f\u5206\u6790--\u5e38\u7528\u547d\u4ee4",description:"GC",source:"@site/docs/01.\u6280\u672f\u7b14\u8bb0/02.\u540e\u7aef/04.Python/06.python\u5185\u5b58\u6cc4\u6f0f\u5206\u6790.md",sourceDirName:"01.\u6280\u672f\u7b14\u8bb0/02.\u540e\u7aef/04.Python",slug:"/pages/7d5dc0/",permalink:"/docs/pages/7d5dc0/",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/01.\u6280\u672f\u7b14\u8bb0/02.\u540e\u7aef/04.Python/06.python\u5185\u5b58\u6cc4\u6f0f\u5206\u6790.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{title:"Python \u5185\u5b58\u6cc4\u6f0f\u5206\u6790--\u5e38\u7528\u547d\u4ee4",date:"2021-01-26T15:32:16.000Z",slug:"/pages/7d5dc0/",categories:["python"]},sidebar:"techwiki",previous:{title:"Python\u7f16\u7801\u89c4\u8303",permalink:"/docs/pages/3d6fc7/"},next:{title:"\u5982\u4f55\u6253\u5305\u53d1\u5e03Python\u5305\u81f3\u79c1\u6709\u4ed3\u5e93",permalink:"/docs/pages/4389c4/"}},i={},l=[{value:"GC",id:"gc",level:2},{value:"Pyrasite",id:"pyrasite",level:2}];function d(e){const t={code:"code",h1:"h1",h2:"h2",pre:"pre",...(0,s.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.h2,{id:"gc",children:"GC"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"gc.enable(); gc.disable(); gc.isenabled()  # \u5f00\u542fgc\uff08\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u662f\u5f00\u542f\u7684\uff09\uff1b\u5173\u95edgc\uff1b\u5224\u65adgc\u662f\u5426\u5f00\u542f\r\ngc.collection()  # \u6267\u884c\u4e00\u6b21\u5783\u573e\u56de\u6536\uff0c\u4e0d\u7ba1gc\u662f\u5426\u5904\u4e8e\u5f00\u542f\u72b6\u6001\u90fd\u80fd\u4f7f\u7528\r\ngc.set_threshold(t0, t1, t2); gc.get_threshold()  # \u8bbe\u7f6e\u5783\u573e\u56de\u6536\u9608\u503c\uff1b \u83b7\u5f97\u5f53\u524d\u7684\u5783\u573e\u56de\u6536\u9608\u503c\r\n# \u6ce8\u610f\uff1agc.set_threshold(0)\u4e5f\u6709\u7981\u7528gc\u7684\u6548\u679c\r\ngc.get_objects() # \u8fd4\u56de\u6240\u6709\u88ab\u5783\u573e\u56de\u6536\u5668\uff08collector\uff09\u7ba1\u7406\u7684\u5bf9\u8c61\u3002\u8fd9\u4e2a\u51fd\u6570\u975e\u5e38\u57fa\u7840\uff01\u53ea\u8981python\u89e3\u91ca\u5668\u8fd0\u884c\u8d77\u6765\uff0c\u5c31\u6709\u5927\u91cf\u7684\u5bf9\u8c61\u88abcollector\u7ba1\u7406\uff0c\u56e0\u6b64\uff0c\u8be5\u51fd\u6570\u7684\u8c03\u7528\u6bd4\u8f83\u8017\u65f6\uff01\r\ngc.get_referents(*obj)  # \u8fd4\u56deobj\u5bf9\u8c61\u76f4\u63a5\u6307\u5411\u7684\u5bf9\u8c61\r\ngc.get_referrers(*obj)  # \u8fd4\u56de\u6240\u6709\u76f4\u63a5\u6307\u5411obj\u7684\u5bf9\u8c61\r\n\n"})}),"\n",(0,n.jsx)(t.h2,{id:"pyrasite",children:"Pyrasite"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"$ pyrasite -l  # \u663e\u793a\u53ef\u4ee5\u4f7f\u7528\u7684\u811a\u672c\r\n$ pyrasite-memory-viewer pid  # \u67e5\u770b\u5f53\u524d\u8fdb\u7a0b\u7684\u6700\u5927\u5bf9\u8c61\r\n$ pyrasite-shell pid # \u8fdb\u5165\u8c03\u8bd5\r\n# globals()\u548clocals()\u67e5\u770b\u5168\u5c40\u548c\u672c\u5730\u53d8\u91cf\n"})}),"\n",(0,n.jsx)(t.h1,{id:"objgraph",children:"objgraph"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"(Pdb) import objgraph\r\n(Pdb) objgraph.show_most_common_types(limit=20)  # \u67e5\u770b\u6700\u5e38\u7528\u7684\u7c7b\u578b\r\nfunction                   22750\r\ndict                       15520\r\ntuple                      12536\r\nweakref                    6679\r\nlist                       5516\r\ntype                       3449\r\ngetset_descriptor          3408\r\ncell                       2566\r\nset                        2496\r\n\r\n(Pdb) objgraph.show_growth(limit=10) # \u67e5\u770b\u589e\u957f\u6700\u5feb\u7684\u7c7b\u578b\r\nfunction             22749    +22749\r\ndict                 15515    +15515\r\ntuple                12332    +12332\r\nweakref               6680     +6680\r\nlist                  5517     +5517\r\ntype                  3449     +3449\r\ngetset_descriptor     3408     +3408\r\ncell                  2565     +2565\r\nset                   2496     +2496\r\nModuleSpec            1588     +1588\r\n\r\nobjgraph.by_type('list')  #  \u67e5\u770b\u67d0\u4e2a\u7c7b\u578b\n"})}),"\n",(0,n.jsx)(t.h1,{id:"pympler",children:"pympler"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-python",children:"(Pdb) from pympler import tracker\r\n(Pdb) tr = tracker.SummaryTracker()\r\n(Pdb) tr.print_diff()\r\n\r\n                  types |   # objects |   total size\r\n======================= | =========== | ============\r\n           <class 'list |       12769 |      1.18 MB\r\n            <class 'str |       12769 |    950.47 KB\r\n            <class 'int |        2513 |     68.71 KB\r\n           <class 'code |           1 |    144     B\r\n  function (store_info) |           1 |    136     B\r\n           <class 'cell |           2 |     96     B\r\n          <class 'tuple |           1 |     64     B\r\n         <class 'method |          -1 |    -64     B\r\n           <class 'dict |           0 |   -128     B\r\n(Pdb) tr.print_diff()\r\n         types |   # objects |   total size\r\n============== | =========== | ============\r\n  <class 'list |           1 |     88     B\r\n   <class 'str |           1 |     70     B\r\n(Pdb) tr.print_diff()\r\n  types |   # objects |   total size\r\n======= | =========== | ============\r\n(Pdb)\n"})})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(d,{...e})}):d(e)}},28453:(e,t,r)=>{r.d(t,{R:()=>o,x:()=>a});var n=r(96540);const s={},c=n.createContext(s);function o(e){const t=n.useContext(c);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),n.createElement(c.Provider,{value:t},e.children)}}}]);